/* ===== MOBILE SAFE AREA FIXES ===== */
@media (max-width: 768px) {
  #game-container {
    padding-bottom: calc(16px + env(safe-area-inset-bottom, 0px));
  }
  .control-btn {
    bottom: calc(var(--spacing-md) + env(safe-area-inset-bottom, 0px));
  }
  #replay-btn {
    right: calc(var(--spacing-md) + env(safe-area-inset-right, 0px));
  }
}
/* ===== CSS VARIABLES (DESIGN TOKENS) ===== */
:root {
  /* Square/Cell sizes */
  --square-size: 35px;
  --square-font-size: 20px;
  --square-gap: 1px;
  --square-border-radius: 6px;
  --square-border-width: 2px;
  
  /* Colors - Borders */
  --color-border-default: #888;
  --color-border-light: rgba(0, 0, 0, 0.3);
  
  /* Colors - Backgrounds */
  --color-bg-body: #2c3e50;
  --color-bg-container: #f5f5f5;
  --color-bg-square: white;
  --color-bg-filled: #e3f2fd;
  --color-bg-transparent: transparent;
  
  /* Colors - Text */
  --color-text-primary: #333;
  --color-text-secondary: #555;
  --color-text-hint: rgba(0, 0, 0, 0.3);
  --color-text-dark: #222;
  --color-text-darker: #111;
  
  /* Colors - Buttons */
  --color-btn-primary: #2196f3;
  --color-btn-primary-hover: #0b7dda;
  --color-btn-success: #4caf50;
  --color-btn-success-hover: #45a049;
  --color-btn-warning: #ff9800;
  --color-btn-warning-hover: #e68900;
  --color-btn-danger: #f44336;
  --color-btn-danger-hover: #d32f2f;
  --color-btn-disabled-bg: #eee;
  --color-btn-disabled-border: #bbb;
  --color-btn-disabled-text: #aaa;
  
  /* Spacing */
  --spacing-xs: 2px;
  --spacing-sm: 10px;
  --spacing-md: 20px;
  --spacing-lg: 30px;
  --spacing-xl: 40px;
  
  /* Layout */
  --container-width: 420px;
  --container-height: 90vh;
  --container-max-height: 800px;
  --container-border-radius: 12px;
  
  /* Mobile-specific layout (full viewport) */
  --mobile-container-width: 100vw;
  --mobile-container-height: 100dvh;
  --mobile-border-radius: 0;
  
  /* Z-index layers */
  --z-base: 2;
  --z-svg: 5;
  --z-undo: 10;
  --z-controls: 100;
  --z-editor: 100;
  --z-success: 1000;
  --z-dragging: 1000;
  --z-error: 2000;
  --z-editor-screen: 2000;
}

/* ===== RESPONSIVE BREAKPOINTS ===== */
/* Mobile devices - full viewport fit */
@media (max-width: 768px) {
  :root {
    --square-size: 30px;
    --square-font-size: 17px;
    --spacing-xl: 30px;
    --container-width: var(--mobile-container-width);
    --container-height: var(--mobile-container-height);
    --container-max-height: none;
    --container-border-radius: var(--mobile-border-radius);
  }
}

@media (max-width: 500px) {
  :root {
    --square-size: 24px;
    --square-font-size: 14px;
    --spacing-xl: 25px;
    --container-width: var(--mobile-container-width);
    --container-height: var(--mobile-container-height);
    --container-max-height: none;
    --container-border-radius: var(--mobile-border-radius);
  }
}

@media (max-width: 350px) {
  :root {
    --square-size: 18px;
    --square-font-size: 11px;
    --spacing-xl: 20px;
    --container-width: var(--mobile-container-width);
    --container-height: var(--mobile-container-height);
    --container-max-height: none;
    --container-border-radius: var(--mobile-border-radius);
  }
}

/* ===== GLOBAL RESET ===== */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  background: var(--color-bg-body);
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  /* Prevent scrolling on mobile */
  position: fixed;
  width: 100%;
  height: 100%;
}

/* ===== MAIN GAME CONTAINER ===== */
#game-container {
  width: var(--container-width);
  height: var(--container-height);
  max-height: var(--container-max-height);
  position: relative;
  display: flex;
  flex-direction: column;
  background: var(--color-bg-container);
  border-radius: var(--container-border-radius);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  overflow: hidden;
}

/* Mobile-specific container adjustments */
@media (max-width: 768px) {
  body {
    background: var(--color-bg-container);
  }
  
  #game-container {
    box-shadow: none;
  }
}

/* ===== SVG CONNECTIONS LAYER ===== */
#svg-connections {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: var(--z-svg);
}

/* ===== WORD SLOTS AREA (TOP 60%) ===== */
#word-slots-area {
  height: 60%;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  z-index: var(--z-base);
}

#word-slots {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xl);
  align-items: center;
}

.word-slot {
  display: flex;
  flex-direction: row;
  gap: var(--square-gap);
  position: relative;
}

/* ===== GAME SQUARES (SHARED STYLES) ===== */
.word-cell,
.bank-letter {
  width: var(--square-size);
  height: var(--square-size);
  font-size: var(--square-font-size);
  font-weight: bold;
  color: var(--color-text-primary);
  border: var(--square-border-width) solid var(--color-border-default);
  border-radius: var(--square-border-radius);
  background: var(--color-bg-square);
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

/* ===== WORD CELL VARIATIONS ===== */
.word-cell.hint {
  color: var(--color-text-hint);
}

.word-cell.filled {
  background: var(--color-bg-filled);
}

/* ===== WORD BANK AREA (BOTTOM 40%) ===== */
#word-bank-area {
  height: var(--word-bank-area-height);
  width: 100%;
  background: var(--color-bg-transparent);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: var(--spacing-lg);
  position: relative;
  z-index: var(--z-base);
}

#word-bank {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  align-items: center;
  position: relative;
  width: 100%;
}

.bank-word-wrapper {
  position: relative;
  height: 40px;
}

.bank-word {
  display: flex;
  flex-direction: row;
  gap: var(--square-gap);
  position: relative;
  cursor: grab;
  user-select: none;
  transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.bank-word.dragging {
  cursor: grabbing;
  z-index: var(--z-dragging);
  transition: none;
}

.bank-word.hidden {
  visibility: hidden;
  pointer-events: none;
}

.bank-letter:last-child {
  margin-right: 0;
}

/* ===== UNDO BUTTON ===== */
.undo-btn {
  position: absolute;
  right: var(--spacing-md);
  bottom: 30%;
  width: 56px;
  min-height: 68px;
  background: var(--color-bg-square);
  border: var(--square-border-width) solid var(--color-border-default);
  border-radius: 8px;
  color: var(--color-text-primary);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  cursor: pointer;
  z-index: var(--z-undo);
  transition: background 0.2s, border-color 0.2s, color 0.2s;
  user-select: none;
  padding: var(--spacing-xs) 0 var(--spacing-xs) 0;
  gap: 0;
}

.undo-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  margin-top: var(--spacing-xs);
}

.undo-label {
  display: block;
  width: 100%;
  text-align: center;
  font-size: 10px;
  color: var(--color-text-dark);
  margin-top: var(--spacing-xs);
  letter-spacing: 0.5px;
  font-weight: bold;
}

.undo-count {
  display: block;
  width: 100%;
  text-align: center;
  font-size: 12px;
  color: var(--color-text-darker);
  margin-top: var(--spacing-xs);
  line-height: 1.1;
  font-weight: bold;
}

.undo-btn:disabled,
.undo-btn.disabled {
  background: var(--color-btn-disabled-bg);
  border-color: var(--color-btn-disabled-border);
  color: var(--color-btn-disabled-text);
  cursor: not-allowed;
}

.undo-btn:not(:disabled):hover {
  background: var(--color-bg-filled);
  border-color: var(--color-btn-primary);
}

/* Mobile safe area adjustments for undo button */
@media (max-width: 768px) {
  .undo-btn {
    right: calc(var(--spacing-md) + env(safe-area-inset-right));
  }
}

/* ===== CONTROL BUTTONS ===== */
.control-btn {
  position: absolute;
  bottom: var(--spacing-md);
  padding: 12px 24px;
  font-size: 16px;
  font-weight: bold;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: var(--color-btn-success);
  color: white;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  z-index: var(--z-controls);
  transition: background 0.3s;
}

.control-btn:hover {
  background: var(--color-btn-success-hover);
}

#replay-btn {
  right: var(--spacing-md);
}

#next-btn {
  background: var(--color-btn-primary);
}

#next-btn:hover {
  background: var(--color-btn-primary-hover);
}

/* Mobile safe area adjustments for bottom buttons */
@media (max-width: 768px) {
  .control-btn {
    bottom: calc(var(--spacing-md) + env(safe-area-inset-bottom));
  }
  
  #replay-btn {
    right: calc(var(--spacing-md) + env(safe-area-inset-right));
  }
}

/* ===== SUCCESS SCREEN ===== */
#success-screen {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255, 255, 255, 0.95);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: var(--z-success);
}

#success-screen h2 {
  font-size: var(--square-font-size);
  width: var(--square-size);
  height: var(--square-size);
  margin-bottom: 1.5em;
}

#success-screen .control-btn {
  margin-top: 0.5em;
  margin-bottom: 0;
  align-self: center;
}

/* ===== ERROR ANIMATION ===== */
.error-cross {
  position: fixed;
  width: 40px;
  height: 40px;
  pointer-events: none;
  z-index: var(--z-error);
  animation: error-fade 0.7s ease-out;
}

@keyframes error-fade {
  0% {
    opacity: 1;
    transform: scale(0.5);
  }
  50% {
    opacity: 1;
    transform: scale(1.0);
  }
  100% {
    opacity: 0;
    transform: scale(1);
  }
}

@keyframes slot-flicker {
  0%, 100% {
    border-color: var(--color-border-default);
  }
  50% {
    border-color: #4caf50;
  }
}

/* ===== EDITOR SCREEN ===== */
#editor-screen {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: white;
  overflow-y: auto;
  padding: var(--spacing-lg);
  z-index: var(--z-editor-screen);
}

#editor-screen h2 {
  text-align: center;
  color: var(--color-text-primary);
  margin-bottom: var(--spacing-lg);
}

.editor-section {
  margin-bottom: var(--spacing-lg);
  padding: var(--spacing-md);
  background: var(--color-bg-container);
  border-radius: 8px;
}

.editor-section h3 {
  margin-bottom: 15px;
  color: var(--color-text-secondary);
}

.editor-input-group {
  display: flex;
  gap: var(--spacing-sm);
  margin-bottom: 15px;
}

.editor-input-group input {
  flex: 1;
  padding: var(--spacing-sm);
  font-size: 16px;
  border: 2px solid #ddd;
  border-radius: 4px;
}

.editor-input-group button,
.editor-actions button {
  padding: var(--spacing-sm) var(--spacing-md);
  font-size: 16px;
  font-weight: bold;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  background: var(--color-btn-primary);
  color: white;
  transition: background 0.3s;
}

.editor-input-group button:hover,
.editor-actions button:hover {
  background: var(--color-btn-primary-hover);
}

#editor-slots-list,
#editor-bank-list,
#editor-conn-list {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-sm);
}

.editor-item {
  padding: 8px 16px;
  background: white;
  border: 2px solid var(--color-btn-primary);
  border-radius: 4px;
  display: flex;
  align-items: center;
  gap: var(--spacing-sm);
  font-weight: bold;
}

.editor-item .remove-btn {
  background: var(--color-btn-danger);
  color: white;
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  cursor: pointer;
  font-size: 16px;
  line-height: 1;
}

.editor-item .remove-btn:hover {
  background: var(--color-btn-danger-hover);
}

.editor-actions {
  display: flex;
  justify-content: center;
  gap: var(--spacing-md);
  margin-top: var(--spacing-lg);
}

#editor-save {
  background: var(--color-btn-success);
}

#editor-save:hover {
  background: var(--color-btn-success-hover);
}

#editor-exit {
  background: var(--color-btn-warning);
}

#editor-exit:hover {
  background: var(--color-btn-warning-hover);
}

/* ===== EDITOR CONTAINER AND CONTROLS ===== */
#editor-container {
  display: none;
  height: 100vh;
  width: 100vw;
  position: fixed;
  top: 0;
  left: 0;
  background: var(--color-bg-container);
  z-index: var(--z-editor);
}

#editor-container.show {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--spacing-md);
}

#editor-controls {
  min-width: 240px;
  max-width: 240px;
  padding: var(--spacing-md);
  background: var(--color-bg-square);
  border-radius: var(--container-border-radius);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  height: fit-content;
}

#editor-controls h2 {
  margin-bottom: var(--spacing-md);
  color: var(--color-text-primary);
  font-size: 24px;
}

#editor-controls input,
#editor-controls button {
  padding: var(--spacing-sm);
  font-size: 14px;
  border-radius: 6px;
  border: 2px solid #ddd;
}

#editor-controls button {
  background: var(--color-btn-primary);
  color: white;
  border: none;
  cursor: pointer;
  font-weight: bold;
  transition: background 0.3s;
}

#editor-controls button:hover {
  background: var(--color-btn-primary-hover);
}

#editor-game-view {
  width: var(--container-width);
  height: var(--container-height);
  max-height: var(--container-max-height);
  position: relative;
  background: var(--color-bg-square);
  border-radius: var(--container-border-radius);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  overflow: hidden;
}

#editor-svg-connections {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: var(--z-svg);
}

#editor-word-slots-area {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 60%;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: var(--z-base);
}

#editor-word-slots {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-xl);
  align-items: center;
}

#editor-word-bank-area {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: var(--word-bank-area-height);
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: var(--spacing-lg);
  z-index: var(--z-base);
  background: rgba(76, 175, 80, 0.4); /* transparent, 60% transparent green */
}

#editor-word-bank {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-md);
  align-items: center;
  position: relative;
  width: 100%;
}

/* ===== UTILITY CLASSES ===== */
.hidden {
  display: none !important;
}

.invisible {
  visibility: hidden !important;
  pointer-events: none !important;
}
